package com.microservices.demo.service;nnimport com.microservices.demo.entity.Review;nimport com.microservices.demo.repository.ReviewRepository;nimport org.springframework.beans.factory.annotation.Autowired;nimport org.springframework.stereotype.Service;nnimport java.util.List;nimport java.util.Optional;nn@Servicenpublic class ReviewService {nn    @Autowiredn    private ReviewRepository reviewRepository;nn    public List<Review> getReviewsByBookId(Long bookId) {n        return reviewRepository.findByBookIdOrderByCreatedAtDesc(bookId);n    }nn    public Review createReview(Review review) {n        return reviewRepository.save(review);n    }nn    public Optional<Review> getReviewById(Long id) {n        return reviewRepository.findById(id);n    }nn    public Review updateReview(Long id, Review reviewDetails) {n        Review review = reviewRepository.findById(id)n                .orElseThrow(() -> new RuntimeException("Review not found"));nn        review.setReviewerName(reviewDetails.getReviewerName());n        review.setRating(reviewDetails.getRating());n        review.setComment(reviewDetails.getComment());nn        return reviewRepository.save(review);n    }nn    public void deleteReview(Long id) {n        Review review = reviewRepository.findById(id)n                .orElseThrow(() -> new RuntimeException("Review not found"));n        reviewRepository.delete(review);n    }nn    public Double getAverageRatingByBookId(Long bookId) {n        return reviewRepository.getAverageRatingByBookId(bookId);n    }nn    public Long getReviewCountByBookId(Long bookId) {n        return reviewRepository.getReviewCountByBookId(bookId);n    }nn    public List<Review> getReviewsByRating(Integer rating) {n        return reviewRepository.findByRating(rating);n    }n}